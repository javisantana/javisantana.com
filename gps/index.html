<!doctype html>
<html lang=en>
  <head>
  <meta charset=utf-8>
  <title>tracker</title>
    <style>
      html {
        font-family: Helvetica;
        padding: 20px;
      }
      .button {
        padding: 20px 30px;
        background: #333;
        color: white;
        font-weight: bold;
        font-size: 1.5em;
        text-transform:uppercase;
      }
      #speed {
        font-size: 10em;
      }
    </style>
  </head>
<body>
  <a id="start_btn" class="button">start</a>
  <div id="speed">0</div>
  <script src="NoSleep.min.js"></script>
  <script>
      // https://stackoverflow.com/questions/59471449/how-to-prevent-screen-sleep-using-javascript
        var noSleep = new NoSleep();
        var playFn = function() {
            noSleep.enable();
            document.body.removeEventListener('touchend', playFn);
            const options = {
              enableHighAccuracy: true,
              maximumAge: 30000,
              timeout: 27000
            };
            function printPos(p) {
              console.log(p);
              document.body.insertAdjacentHTML('beforeend',
                `<div>${p.timestamp},${p.coords.latitude},${p.coords.latitude}, ${p.coords.altitude},${p.coords.speed}</div>`
              )
              if(p.coords.speed)
               document.getElementById('speed').innerHTML = (3.6 * p.coords.speed).toFixed(2)

            }
            const watchID = navigator.geolocation.watchPosition(printPos, (e) => console.log(e), options);
            //setInterval(() => { }, 1000)
            navigator.geolocation.getCurrentPosition(printPos, (e) => console.log(e), options);
            document.getElementById('start_btn').style.display = 'none';
          
      }
      document.body.addEventListener('touchend', playFn);
      document.body.addEventListener('click', playFn);
  </script>
</body>
</html>
